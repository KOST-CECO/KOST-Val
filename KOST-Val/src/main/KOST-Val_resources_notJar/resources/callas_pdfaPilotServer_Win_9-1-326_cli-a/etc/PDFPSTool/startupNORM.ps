%!
%*************************************************************************
%*
%* ADOBE CONFIDENTIAL
%* ___________________
%*
%*  Copyright 1990 - 2001 Adobe Systems Incorporated
%*  All Rights Reserved.
%*
%* NOTICE:  All information contained herein is, and remains
%* the property of Adobe Systems Incorporated and its suppliers,
%* if any.  The intellectual and technical concepts contained
%* herein are proprietary to Adobe Systems Incorporated and its
%* suppliers and may be covered by U.S. and Foreign Patents,
%* patents in process, and are protected by trade secret or copyright law.
%* Dissemination of this information or reproduction of this material
%* is strictly forbidden unless prior written permission is obtained
%* from Adobe Systems Incorporated.
%**************************************************************************
%
% startupNorm.ps
%
%%%%%%%%%% DO NOT EDIT THIS FILE %%%%%%%%%%%%%%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% This gets run as an exitserver job just after the PostScript
% server gets initialized.
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Make RunFile accessible in userdict
%
userdict /RunFile { /DistillOps /ProcSet findresource /RunFile get exec } bind put

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Set up CJK font environment
{
	% only try this if psdisk directory tree is installed
	(Sys/Start) status
	{
		pop pop pop pop % status results
		% Set this, else the CSL cannot find resources (other than fonts)
		<< /GenericResourceDir (Resource/) >> setsystemparams

		(Sys/Start) run
		
		% Pre-load some Procsets
		/CompatibleFonts /ProcSet findresource pop

		(CID support library initialization completed.\n) print flush
	} if
	
	% Modify the ResourceFileName proc in the following resource categories
	% to use distiller's RedefineResourceFileName 
	currentglobal true setglobal
	[/CIDFont /CMap]
	{/DistillOps /ProcSet findresource /RedefineResourceFileName get exec}
	forall
	setglobal

	
} stopped
{
	(ERROR: CID support library initialization failed. CID fonts disabled.\n) print flush
} if

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  run any of the user's startup jobs
%
globaldict begin /allow_startjob false def end
(Startup/*) { RunFile } 256 string filenameforall
globaldict begin /allow_startjob true def end


%
% Clean up userdict after loading fonts: Some older fonts left some
% definitions in userdict. These definitions may conflict with the
% PostScript code generated by the Adobe Windows PostScript driver.
% It is therefore wise to remove them during the startup job before
% the first user job arrives.
% This fixes 423132.

[/| /|- /-| /RD /ND /NP] {
  dup userdict exch known {
   userdict exch undef
  }{
    pop
  } ifelse
} forall


% Changes for CJK download

% Define /CPSI ProcSet in the context of internaldict to bind operators
/CPSI 4 dict dup begin
  /variables 
  << 
  	/emulatePSFileSystem true
  >> def
  /cpsiinitialize {} bind executeonly def
  /externalcommand {} def
  /engineconfiguration {} def
end /ProcSet defineresource pop

<< 
	/MaxStoredFontCache -1

	/GenericResourceDir (Resource/)
	/FontResourceDir (fonts/)
	/Password (0)

>> setsystemparams
% end of changes for CJK download

%  End of file.

